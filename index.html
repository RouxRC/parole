<!DOCTYPE html>
<html>
 <head>
  <meta charset="UTF-8">
  <title>Parole - Regards Citoyens</title>
  <link href="css/roboto.css" rel="stylesheet">
  <link href="css/vuetify.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
 </head>
 <body>
  <div id="parole"><v-app dark toolbar>
    <aside class="navigation-drawer navigation-drawer--absolute navigation-drawer--clipped navigation-drawer--is-booted navigation-drawer--is-mobile navigation-drawer--open navigation-drawer--permanent">
      <v-list dense>
        <v-subheader class="mt-2 grey--text text--darken-1">Législature</v-subheader>
        <v-list-tile ripple>
          <v-list-tile-content><v-select auto single-line hide-details disabled
            v-model="legislature"
            :items="legislatures"
            item-text="name"
            item-value="id"
            prepend-icon="account_balance"
            class="select"
            @change="legislature = $event"
          ></v-select></v-list-tile-content>
        </v-list-tile>

        <v-subheader class="grey--text text--darken-1">Type d'activité</v-subheader>
        <v-list-tile ripple>
          <v-list-tile-content><v-select auto single-line hide-details
            v-model="activite"
            :items="activites"
            item-text="name"
            item-value="id"
            :prepend-icon="activiteIcon"
            class="select"
            @change="activite = $event"
          >
            <template slot="item" scope="f">
              <v-list-tile-action><v-icon v-html="f.item.icon"></v-icon></v-list-tile-action>
              <v-list-tile-content><v-list-tile-title v-html="f.item.name"></v-list-tile-title></v-list-tile-content>
            </template>
          </v-select></v-list-tile-content>
        </v-list-tile>

        <v-subheader class="grey--text text--darken-1">Répartition entre</v-subheader>
        <v-list-tile ripple>
          <v-list-tile-content><v-select auto single-line hide-details
            v-model="facet"
            :items="availableFacets"
            item-text="name"
            item-value="id"
            :prepend-icon="facetIcon"
            class="select"
            @change="facet = $event"
          >
            <template slot="item" scope="f">
              <v-list-tile-action><v-icon v-html="f.item.icon"></v-icon></v-list-tile-action>
              <v-list-tile-content><v-list-tile-title v-html="f.item.name"></v-list-tile-title></v-list-tile-content>
            </template>
          </v-select></v-list-tile-content>
        </v-list-tile>

        <v-subheader class="grey--text text--darken-1">Comparer entre</v-subheader>
        <v-list-tile ripple>
          <v-list-tile-content><v-select auto single-line hide-details
            v-model="compare"
            :items="availableCompare"
            item-text="name"
            item-value="id"
            :prepend-icon="compareIcon"
            :class="{'unselected': !compare, 'select': true}"
            @change="compare = $event"
          >
            <template slot="item" scope="f">
              <v-list-tile-action><v-icon v-html="f.item.icon"></v-icon></v-list-tile-action>
              <v-list-tile-content><v-list-tile-title v-html="f.item.name"></v-list-tile-title></v-list-tile-content>
            </template>
          </v-select></v-list-tile-content>
        </v-list-tile>

        <v-subheader class="mt-4 grey--text text--darken-1">Filtrage
          <v-spacer></v-spacer>
          <v-chip small outline close class="red--text"
            v-model="filtered"
            @input="clearFilters()"
            @click="clearFilters()"
          ><small>annuler</small></v-chip>
        </v-subheader>
        <v-list-tile
          v-for="item in facets"
          v-if="(!item.only || item.only === activite) && item.id !== facet"
          :class="{'unselected': item.selected === 'total'}"
        >
          <v-list-tile-action><v-icon>{{ item.icon }}</v-icon></v-list-tile-action>
          <v-list-tile-content><v-select auto
            v-model="item.selected"
            :label="item.filterName"
            :items="[{id: 'total', 'name': item.filterAll}].concat(item.legende)"
            item-text="name"
            item-value="id"
            class="input-group--focused"
            @change="selectFilter(item.id, $event)"
          ></v-select></v-list-tile-content>
        </v-list-tile>

        <v-subheader class="mt-4 grey--text text--darken-1">Affichage</v-subheader>
        <v-list-tile>
          <v-list-tile-action><v-icon>date_range</v-icon></v-list-tile-action>
          <v-radio-group row hide-details v-model="temps">
            <v-radio small color="red" v-for="c in ['jours', 'sems', 'mois']" :label="c" :value="c"></v-radio>
          </v-radio-group>
        </v-list-tile>
        <v-list-tile>
          <v-list-tile-action><v-icon>timeline</v-icon></v-list-tile-action>
          <v-list-tile-content><v-list-tile-title>Cumulatif</v-list-tile-title></v-list-tile-content>
          <v-list-tile-action><v-switch light v-model="cumul" color="red"></v-switch></v-list-tile-action>
        </v-list-tile>
        <v-list-tile>
          <v-list-tile-action><v-icon>dashboard</v-icon></v-list-tile-action>
          <v-list-tile-content><v-list-tile-title>Proportionnel</v-list-tile-title></v-list-tile-content>
          <v-list-tile-action><v-switch light v-model="prop" color="red"></v-switch></v-list-tile-action>
        </v-list-tile>

        <v-subheader class="mt-4 grey--text text--darken-1">Open Data</v-subheader>
        <v-list-tile ripple :href="'data/' + this.dkey + '.tsv'">
          <v-list-tile-action><v-icon>file_download</v-icon></v-list-tile-action>
          <v-list-tile-content><v-list-tile-title>Télécharger</v-list-tile-title></v-list-tile-content>
        </v-list-tile>
      </v-list>
      <div class="navigation-drawer__border"></div>
    </aside>
    <v-toolbar class="red" fixed>
      <v-toolbar-title>
        <a href="https://www.RegardsCitoyens.org" target="_blank" class="avatar mr-3">
          <img src="img/RC-avatar.png" title="Regards Citoyens" alt="RC">
        </a>
        {{ titre }}
      </v-toolbar-title>
      <v-spacer></v-spacer>
      <v-btn fab small outline class="red ml-3" @click.native.stop="help = true">
        <v-icon medium class="red">help</v-icon>
      </v-btn>
    </v-toolbar>
    <main>
      <div class="svg" style="height: 6000px"></div>
      <center><div class="legende">
        <button v-for="option in legende" class="btn btn--disabled btn--raised" :style="{'background-color': option.color+'!important'}">
          <div class="btn__content">
            <span>{{ option.facetName || option.name || option.id }}</span>
            <span v-if="showValues && option.value" class="lowercase"><small>{{ option.value }}&nbsp;{{ unit }}</small></span>
          </div>
        </button>
      </div></center>
    </main>
    <div class="tooltipBox"><center><b>{{ hoverDate }}</b></center></div>
    <v-dialog v-model="help" width="33%">
      <v-card>
        <v-card-title class="headline">Parole <small>&nbsp;&nbsp;par&nbsp;<a href="https://www.regardscitoyens.org" target="_blank">Regards Citoyens</a></small></v-card-title>
        <v-card-text>Réalisé à partir des <a href="https://github.com/regardscitoyens/nosdeputes.fr/blob/master/doc/opendata.md" target="_blank">données</a> de <a href="https://www.nosdeputes.fr" target="_blank">NosDéputés.fr</a> à l'aide de <a href="https://vuejs.org" target="_blank">VueJS</a> et <a href="https://vuetifyjs.com/" target="_blank">VuetifyJS</a>.</v-card-text>
        <v-card-text>Cette application est un logiciel libre sous licence AGPL dont le code source est <a href="https://github.com/rouxrc/parole" target="_blank">disponible sur GitHub</a>.</v-card-text>
        <v-card-actions>
          <v-spacer></v-spacer>
          <v-btn class="red--text darken-1" flat @click.native="help = false">Fermer</v-btn>
        </v-card-actions>
      </v-card>
    </v-dialog>
  </v-app></div>

  <script type="text/javascript" src="js/d3.v4.min.js"></script>
  <script type="text/javascript" src="js/vue.min.js"></script>
  <script type="text/javascript" src="js/vuetify.min.js"></script>
  <script type="text/javascript" src="js/parole.js"></script>
 </body>
</html>
